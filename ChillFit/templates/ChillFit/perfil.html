{% extends 'ChillFit/base.html' %}
{% load static %}

{% block title %}Mi Perfil{% endblock %}

{% block content %}
<div class="container mt-4 d-flex justify-content-center">
    <div class="col-md-6 col-lg-5 shadow p-3 rounded bg-light mb-4">

        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        {% if messages %}
        <script>
            {% for message in messages %}
                Swal.fire({
                    title: "{% if message.tags == 'success' %}¡Éxito!{% elif message.tags == 'error' %}Error{% else %}Aviso{% endif %}",
                    text: "{{ message }}",
                    icon: "{% if message.tags == 'success' %}success{% elif message.tags == 'error' %}error{% else %}info{% endif %}",
                    confirmButtonText: "Aceptar"
                });
            {% endfor %}
        </script>
        {% endif %}

        <form method="post" enctype="multipart/form-data" class="mt-2">
            {% csrf_token %}

            <!-- Email -->
            <div class="mb-2">
                <label for="id_email">Email</label>
                <input type="email" class="form-control" id="id_email" value="{{ user.email }}" disabled placeholder="Email">
            </div>

            <!-- Nombre de Usuario -->
            <div class="mb-2">
                <label for="id_username">Nombre de Usuario</label>
                <input type="text" class="form-control" name="username" id="id_username" value="{{ user.username }}" placeholder="Nombre de Usuario">
            </div>

            <!-- Teléfono y Edad -->
            <div class="row">
                <div class="col-6">
                    <div class="mb-2">
                        <label for="id_telefono">Teléfono</label>
                        <input type="text" class="form-control" name="telefono" id="id_telefono" value="{{ perfil.telefono }}" placeholder="Teléfono">
                    </div>
                </div>
                <div class="col-6">
                    <div class="mb-2">
                        <label for="id_edad">Edad</label>
                        <input type="number" class="form-control" name="edad" id="id_edad" value="{{ perfil.edad }}" placeholder="Edad">
                    </div>
                </div>
            </div>

            <!-- Sexo y Plan -->
            <div class="row">
                <div class="col-6">
                    <div class="mb-2">
                        <label for="id_sexo">Sexo</label>
                        <select class="form-select" name="sexo" id="id_sexo">
                            <option value="">---------</option>
                            <option value="M" {% if perfil.sexo == "M" %}selected{% endif %}>Masculino</option>
                            <option value="F" {% if perfil.sexo == "F" %}selected{% endif %}>Femenino</option>
                            <option value="O" {% if perfil.sexo == "O" %}selected{% endif %}>Otro</option>
                        </select>
                    </div>
                </div>
                <div class="col-6">
                    <div class="mb-2">
                        <label for="id_plan">Plan de Trabajo</label>
                        <select class="form-select" name="plan" id="id_plan">
                            <option value="">---------</option>
                            {% for plan in planes %}
                                <option value="{{ plan.id }}"
                                    {% if perfil.plan_de_trabajo and perfil.plan_de_trabajo.id == plan.id %}selected{% endif %}>
                                    {{ plan.nombre }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>

            <!-- Avatar -->
            <div class="mb-2">
                <label for="id_avatar">Avatar</label>
                <input type="file" class="form-control" name="avatar" id="id_avatar">
                {% if perfil.avatar %}
                    <div class="mt-2 text-center">
                        <img src="{{ perfil.avatar.url }}" alt="Avatar actual" class="img-thumbnail" width="80">
                    </div>
                {% endif %}
            </div>

            <!-- Botón -->
            <div class="text-center mt-3">
                <button type="submit" class="btn btn-primary btn-sm w-100">Guardar cambios</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}


